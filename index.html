<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>真实篮球小游戏（带运球）</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #gameCanvas {
            border: 5px solid #333;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        .tips {
            margin-top: 15px;
            font-size: 16px;
            color: #333;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>真实篮球投篮游戏</h1>
    <canvas id="gameCanvas" width="1200" height="600"></canvas>
    <div class="tips">左右箭头移动人物 | 空格投篮 | 移动时自动运球</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // 1. 加载图片素材
        const bgImg = new Image();
        const playerImg = new Image();
        const ballImg = new Image();
        const hoopImg = new Image();
        // 替换为你的仓库图片路径，或免费图库直链
        bgImg.src = 'bg.jpg'; 
        playerImg.src = 'player.png';
        ballImg.src = 'ball.png';
        hoopImg.src = 'hoop.png';

        // 2. 游戏核心参数
        let playerX = 500;
        const playerY = 400; // 固定在地面
        const playerW = 100;
        const playerH = 150;
        let ballX = playerX + 20;
        let ballY = playerY + 80;
        let ballSpeedY = 0;
        let isShooting = false;
        let isDribbling = false;
        let dribbleAngle = 0; // 运球旋转角度
        let score = 0;

        // 篮筐位置（根据背景图调整坐标）
        const hoopX = 600;
        const hoopY = 180;
        const hoopW = 120;
        const hoopH = 80;

        // 键盘状态
        const keys = { ArrowLeft: false, ArrowRight: false, Space: false };

        // 3. 绘制游戏元素（真实素材版）
        function drawGame() {
            // 绘制背景
            ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

            // 绘制篮筐
            ctx.drawImage(hoopImg, hoopX, hoopY, hoopW, hoopH);

            // 绘制人物
            ctx.drawImage(playerImg, playerX, playerY, playerW, playerH);

            // 绘制篮球：运球时旋转+上下跳动
            if (isDribbling && !isShooting) {
                ctx.save();
                // 旋转中心设为篮球中心
                ctx.translate(ballX + 25, ballY + 25);
                ctx.rotate(dribbleAngle * Math.PI / 180);
                ctx.drawImage(ballImg, -25, -25, 50, 50);
                ctx.restore();
                // 更新运球角度和位置
                dribbleAngle += 10;
                ballY = playerY + 80 + Math.sin(dribbleAngle * Math.PI / 90) * 15;
            } else {
                // 非运球/投篮时，篮球固定在人物手边
                ctx.drawImage(ballImg, ballX, ballY, 50, 50);
            }

            // 绘制得分（带描边）
            ctx.font = '40px Arial';
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 5;
            ctx.strokeText(`得分: ${score}`, 50, 60);
            ctx.fillStyle = '#fff';
            ctx.fillText(`得分: ${score}`, 50, 60);
        }

        // 4. 游戏逻辑更新（含运球判断）
        function updateGame() {
            // 人物移动逻辑
            if (keys.ArrowLeft && playerX > 50) {
                playerX -= 8;
                isDribbling = true;
            } else if (keys.ArrowRight && playerX < canvas.width - playerW - 50) {
                playerX += 8;
                isDribbling = true;
            } else {
                isDribbling = false;
            }

            // 篮球跟随人物（非投篮状态）
            if (!isShooting) {
                ballX = playerX + 20;
            }

            // 投篮逻辑
            if (keys.Space && !isShooting) {
                ballSpeedY = -25;
                isShooting = true;
                isDribbling = false;
            }

            // 篮球抛物线运动（重力）
            if (isShooting) {
                ballY += ballSpeedY;
                ballSpeedY += 1.2; // 重力加速度
                // 篮球落地重置
                if (ballY > canvas.height) {
                    resetBall();
                }
                // 进球判定
                if (ballX > hoopX && ballX < hoopX + hoopW && ballY > hoopY && ballY < hoopY + hoopH) {
                    score++;
                    resetBall();
                }
            }
        }

        // 重置篮球位置和状态
        function resetBall() {
            ballX = playerX + 20;
            ballY = playerY + 80;
            ballSpeedY = 0;
            isShooting = false;
        }

        // 5. 键盘监听
        document.addEventListener('keydown', (e) => {
            switch(e.keyCode) {
                case 37: keys.ArrowLeft = true; break;
                case 39: keys.ArrowRight = true; break;
                case 32: keys.Space = true; e.preventDefault(); break;
            }
        });
        document.addEventListener('keyup', (e) => {
            switch(e.keyCode) {
                case 37: keys.ArrowLeft = false; break;
                case 39: keys.ArrowRight = false; break;
                case 32: keys.Space = false; break;
            }
        });

        // 6. 游戏循环
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawGame();
            updateGame();
            requestAnimationFrame(gameLoop);
        }

        // 图片加载完成后启动游戏
        window.onload = function() {
            gameLoop();
        };
    </script>
</body>
</html>
